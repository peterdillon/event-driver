@if (loadingService.isLoading()) {
  <div id="overlay">
    <nz-icon nzType="loading" class="load-icon" />
  </div>
}
<!-- {{ loadingService.requestCount() }} -->

<nz-splitter nzLayout="vertical">
  <nz-splitter-panel nzDefaultSize="60%" nzMin="20%" nzMax="90%">
      <div class="map-container">
        <div class="map-frame">
          <div id="map"></div>
        </div>
      </div>
  </nz-splitter-panel>

  <nz-splitter-panel>


    <ul nz-menu nzMode="horizontal">
      <li nz-menu-item>
        Sort by:
      </li>
      <li nz-menu-item>
        &nbsp; <nz-icon nzType="user" nzTheme="outline" /> &nbsp; 
      </li>
      <li nz-menu-item>
        &nbsp; <nz-icon nzType="clock-circle" nzTheme="outline" /> &nbsp; 
      </li>
      <li nz-submenu nzIcon="filter">
        <ul>
          <li nz-menu-group nzTitle="Categories" nzPlacement="bottomRight">
            <ul>
              <li nz-menu-item>All</li>
              <li nz-menu-item (click)="getPredictHQ()">Conferences</li>
              <li nz-menu-item>Expos</li>
              <li nz-menu-item>Concerts</li>
              <li nz-menu-item>Sports</li>
              <li nz-menu-item>Festivals</li>
              <li nz-menu-item>Performing Arts</li>
              <li nz-menu-item>Community</li>
              <li nz-menu-item>Politics</li>
            </ul>
          </li>
        </ul>
      </li>
      <!-- <li nz-menu-item>
        <a href="https://ng.ant.design" target="_blank" rel="noopener noreferrer">Navigation Four - Link</a>
      </li> -->
    </ul>

    <!-- Refresh button -->
    <div class="shape">
      <nz-float-button (click)="getPredictHQ()" nzShape="circle" nzType="primary" [nzIcon]="icon"> </nz-float-button>
      <ng-template #icon>
        <nz-icon nzType="redo" nzTheme="outline" />
      </ng-template>
    </div>



    <div class="relative">
      <div class="wrapper">
        <div class="list">
         @for (item of sharedDataService.dataSignal(); track item.id; let i = $index) {
          <div class="item">
              <nz-card [nzBordered]="false" [nzActions]="[map, capacity, endTime]">
                <div class="ant-card-meta-detail">
                  <div class="ant-card-meta-title">{{ item.title }} <span class="cap">({{ item.category }})</span></div>
                  <div class="ant-card-meta-description">
                    <span *ngFor="let e of item.entities">{{ e.name | removeSourced }}, </span>
                  </div>
                  <div class="ant-card-meta-description">{{ item.geo.address.formatted_address }}</div>
                  <div class="ant-card-meta-description">
                    Estimated end time: {{ item.predicted_end ? (item.predicted_end | customEndTime) : (item.end_local | customEndTime) }}
                  </div>
                  <div class="ant-card-meta-description">
                    Start: {{ (item.start | customEndTime) }} or {{ item.start_local | customEndTime }}
                  </div>
              </div>
              </nz-card>
              <ng-template #map>
                <a href="https://www.google.com/maps/dir/Current+Location/{{item.location[1]}},{{item.location[0]}}" target="_blank">
                  Map <nz-icon nzType="environment" nzTheme="outline" />
                </a>
              </ng-template>
              <ng-template #capacity>
                <a href="#">
                  <span *ngIf="item.phq_attendance | isEmpty"> No data</span>
                  {{ item.phq_attendance | shortNumber }} <nz-icon nzType="user" nzTheme="outline" />
                </a>
              </ng-template>
              <ng-template #endTime>
                <app-timer [itemData]="item" [itemIndex]="i"></app-timer> 
              </ng-template>
          </div>
        }
        </div>
      </div>
    </div>
  </nz-splitter-panel>

</nz-splitter>

    